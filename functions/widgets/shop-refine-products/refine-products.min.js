function price_slider_change(e,r){_BH_refine_products_min_handle_price=e,_BH_refine_products_max_handle_price=r,map_taxonomy_terms()}function map_taxonomy_terms(){var e=$(".tax-filter");e.each(function(){var e=$(this).attr("class").split(/\s+/),r=$(this).children(".tax-terms");taxonomy_name="",$.each(e,function(e,r){r.indexOf("tax-filter-")>=0&&(taxonomy_name=r.substring(11))}),r.find("input").each(function(){var e=$(this).attr("id");_BH_refine_products_taxonomies[taxonomy_name][2][e][2]=$(this).is(":checked")?1:0})}),refine_products()}function refine_products(){var e=$(".Shop_Refine_Products .loader");e.show(),$.ajax({url:_BH_refine_products_api,type:"POST",data:{taxonomy:_BH_refine_products_taxonomy,term_id:_BH_refine_products_term_id,min_handle_price:_BH_refine_products_min_handle_price,max_handle_price:_BH_refine_products_max_handle_price,taxonomies:_BH_refine_products_taxonomies},error:function(){return e.hide(),!1},success:function(r){r=JSON.parse(r);var i=r.posts;return update_products_grid(i),update_product_filters(r),e.hide(),!0}})}function update_products_grid(e){if($(".not-found").hide(),$("ul.products li").hide(),$("ul.products li.delimiter").remove(),$("ul.products li").removeClass("first last"),e.length>0){var r=0;$("ul.products li").each(function(){var i=parseInt($(this).attr("data-postid"));-1!=$.inArray(i,e)&&($(this).show(),0==r%3&&($(this).addClass("first"),r>0&&$(this).before('<li class="delimiter"></li>')),0==(r+1)%3&&$(this).addClass("last"),r++)})}else $(".not-found").show()}function update_product_filters(e){var r=parseInt(e.min_price),i=parseInt(e.max_price),t=parseInt(e.min_handle_price),n=parseInt(e.max_handle_price);t=r>t?r:t,n=n>i?i:n,$("#price-filter-slider").slider("option","change",""),$("#price-filter-slider").slider("option",{values:[t,n],min:r,max:i}),$("#price-filter-slider").slider("option",{change:function(e,r){price_slider_change(r.values[0],r.values[1])}}),$("#price-filter-amount").val(_BH_refine_currency+$("#price-filter-slider").slider("values",0)+" - "+_BH_refine_currency+$("#price-filter-slider").slider("values",1)),$.each(e.taxonomies,function(e,r){0==r[1]?$(".tax-filter-"+e).hide():($(".tax-filter-"+e).show(),$.each(r[2],function(e,r){0==r[1]?$(".tax-filter input#"+e).parent("label").hide():($(".tax-filter input#"+e).parent("label").find("span").html(r[0]+" ("+r[1]+")"),$(".tax-filter input#"+e).parent("label").show())}))})}jQuery(function(e){e("#price-filter-slider").slider({animate:!0,range:!0,min:_BH_refine_products_min_price,max:_BH_refine_products_max_price,values:[_BH_refine_products_min_handle_price,_BH_refine_products_max_handle_price],slide:function(r,i){e("#price-filter-amount").val(_BH_refine_currency+i.values[0]+" - "+_BH_refine_currency+i.values[1])},change:function(e,r){price_slider_change(r.values[0],r.values[1])}}),e("#price-filter-amount").val(_BH_refine_currency+e("#price-filter-slider").slider("values",0)+" - "+_BH_refine_currency+e("#price-filter-slider").slider("values",1)),e(".tax-filter .tax-terms input").change(function(){map_taxonomy_terms()})});